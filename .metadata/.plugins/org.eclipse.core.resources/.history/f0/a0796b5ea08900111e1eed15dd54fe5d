/*
 * pbar.h
 *
 *  Created on: Apr 18, 2012
 *      Author: ACM
 */

#ifndef PBAR_H_
#define PBAR_H_

Packet PBAR_runFunction(Widget* this, u8 funcN, Packet* pack);

struct pbar_widget{
	u32 progressBarX, progressBarY;
}PBarWidget;

struct widget newX(struct pbar_widget* derive_type, u32 progressBar_x, u32 progressBar_y){

	struct pbar_widget* w = (struct pbar_widget*) malloc(sizeof(struct pbar_widget));
	w->progressBarX = progressBar_x;
	w->progressBarY = progressBar_y;

	struct widget PBar = {
			.x = 0,
			.y = 0,
			.derive = (const void*)w,
			.runFunction = PBAR_runFunction
	};

	return PBar;
}

Packet PBAR_runFunction(Widget* this, u8 funcN, Packet* pack){

	struct pbar_widget* this = (struct pbar_widget*)(this->derive);

	switch(funcN){

		case 1:{
			//stuff to draw a progress bar here
			drawCircle(this->progressBarX,this->progressBarY,15,BLACK,1);
			drawCircle(this->progressBarX+200,this->progressBarY,15,BLACK,1);
			drawRectangle(this->progressBarX,this->progressBarY-15,this->progressBarX+200,this->progressBarY+15,BLACK,1);
			drawCircle(this->progressBarX,this->progressBarY,13,GREEN,1);
			drawDigit(this->progressBarX-4,this->progressBarY+17,0,BLACK);
			drawNumber(this->progressBarX+188,this->progressBarY+17,100,BLACK);
		}
		case 2:{
			//stuff to draw a progress bar here
			u8 temperature = 0;
			u8 oldTemp = temperature;
			temperature = pack->bytes[0];

			if(oldTemp != temperature)
			{
				drawCircle(this->progressBarX+200,this->progressBarY,13,WHITE,1);
				drawRectangle(this->progressBarX,this->progressBarY-13,this->progressBarX+200,this->progressBarY+13,WHITE,1);
				drawRectangle(this->progressBarX,this->progressBarY-13,this->progressBarX+temperature,this->progressBarY+13,GREEN,1);
				if (temperature==200)
					drawCircle(this->progressBarX+200,this->progressBarY,13,GREEN,1);
			}
		}
	}

}


#endif /* PBAR_H_ */
