/*
 * Empty C++ Application
 */

#include "Graphics.h"
#include "Add.h"
#include "xbasic_types.h"
#include "xuartlite_l.h"
#include "xparameters.h"


	int main()
	{
		int x = 0;
		int y = 215;
		int circleX = 55, circleY = 55;
		int progressBarX = 25, progressBarY = 150;
		u8 color = 1;
		volatile int delayCounter = 0;
		XUartLite_SendByte(XPAR_UARTLITE_1_BASEADDR, 128);

		for (x = 0; x<MAX_WIDTH; ++x)
			for (y = 0; y<MAX_HEIGHT; ++y)
				Xil_Out32(VGA_BASEADDR, ((y*384 + x)<<3)| (7));

		while(XUartLite_RecvByte(XPAR_UARTLITE_1_BASEADDR) != 1);
		while(XUartLite_RecvByte(XPAR_UARTLITE_1_BASEADDR) != 2);
		while(XUartLite_RecvByte(XPAR_UARTLITE_1_BASEADDR) != 3);
		drawCircle(circleX,circleY,50,BLACK,1);
		drawCircle(circleX,circleY,48,WHITE,1);
		for(double i = 0; i <= 6.2831853; i += (3.14159269/12)){
			drawLine(circleX,circleY,(int)(circleX+48*cos(i)),(int)(circleY+48*sin(i)),BLACK);
		}

		//stuff to draw a progress bar here
		drawCircle(progressBarX,progressBarY,15,BLACK,1);
		drawCircle(progressBarX+200,progressBarY,15,BLACK,1);
		drawRectangle(progressBarX,progressBarY-15,progressBarX+200,progressBarY+15,BLACK,1);
		drawCircle(progressBarX,progressBarY,13,GREEN,1);

		while (1==1)
		{

			//stuff to draw a round meter
			u8 degree;
			degree = XUartLite_RecvByte(XPAR_UARTLITE_1_BASEADDR);
			double angle = ((double)degree) * 3.14159/180.0;
			//print("Starting to draw RoundMeter.");
			int x2 = 43*cos(angle) + circleX;
			//int y2 = y + 45*( angle - (angle*angle*angle)/6.0 + (angle*angle*angle*angle*angle)/120.0 - (angle*angle*angle*angle*angle*angle*angle)/5040);
			int y2 = -43*sin(angle) + circleY;

			int deltaX = 6*cos(angle + (3.14/2));
			int deltaY = -6*sin(angle + (3.14/2));

			drawCircle(circleX,circleY,44,WHITE,1);
			drawCircle(circleX,circleY,5,BLUE,1);

			drawTriangle(x2, y2, (circleX+deltaX),(circleY+deltaY),(circleX-deltaX),(circleY-deltaY),BLUE, 1);
			drawLine(circleX,circleY,x2,y2,RED);


			//stuff to draw a progress bar here
			u8 temperature;
			temperature = XUartLite_RecvByte(XPAR_UARTLITE_1_BASEADDR);
			drawCircle(progressBarX+200,progressBarY,13,WHITE,1);
			drawRectangle(progressBarX,progressBarY-13,progressBarX+200,progressBarY+13,WHITE,1);
			drawRectangle(progressBarX,progressBarY-13,progressBarX+temperature,progressBarY+13,GREEN,1);
			if (temperature==200)
				drawCircle(progressBarX+200,progressBarY,13,GREEN,1);

			//stuff to draw some lights here
			u8 buttons;
			buttons = XUartLite_RecvByte(XPAR_UARTLITE_1_BASEADDR);
			unsigned int light_1 = buttons & 0x01;
			unsigned int light_2 = buttons & 0x02;
			unsigned int light_3 = buttons & 0x04;
			unsigned int light_4 = buttons & 0x08;
			if(light_1){
				drawLight(125, 30, RED);
			}else{
				drawLight(125, 30, WHITE);
			}
			if(light_2){
				drawLight(155, 30, RED);
			}else{
				drawLight(155, 30, WHITE);
			}
			if(light_3){
				drawLight(125, 60, RED);
			}else{
				drawLight(125, 60, WHITE);
			}
			if(light_4){
				drawLight(155, 60, RED);
			}else{
				drawLight(155, 60, WHITE);
			}
		}

	return 0;
}
